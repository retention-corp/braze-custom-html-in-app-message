# Coupon Code with Auto-Copy Modal Template

### 개요

쿠폰 코드를 표시하고 원클릭 복사 기능을 제공하는 모달 인앱 메시지입니다. 프로모션 쿠폰, 할인 코드, 바우처 배포에 최적화된 템플릿입니다.

### 주요 기능

- ✅ 쿠폰 코드 표시 (정적 또는 Liquid 동적 코드)
- ✅ 원클릭 복사 기능 (Clipboard API + 폴백)
- ✅ 복사 성공 시각적 피드백
- ✅ 할인 정보 표시 (퍼센트 또는 금액)
- ✅ 쿠폰 조건 정보 (최소 주문 금액, 유효 기간)
- ✅ 사용하기 CTA 버튼
- ✅ 커스텀 이벤트 로깅 (조회, 복사, 사용)
- ✅ 모바일 최적화 그라데이션 디자인

### 미리보기

```
┌──────────────────────────────┐
│                         ✕    │
│  ┌────────────────────┐      │
│  │       30%          │      │
│  │       할인          │      │
│  └────────────────────┘      │
│   특별 할인 쿠폰!            │
│   지금 바로 사용하세요       │
│                              │
│ ┌──────────────────────────┐ │
│ │   쿠폰 코드              │ │
│ │   SAVE30                 │ │
│ │ [ 📋 코드 복사하기 ]     │ │
│ └──────────────────────────┘ │
│                              │
│ 최소 주문 금액   50,000₩    │
│ 최대 할인 금액   15,000₩    │
│ 유효 기간        2026.01.31 │
│                              │
│ [ 지금 사용하기 ]            │
│                              │
│ * 일부 상품 제외             │
│ * 다른 쿠폰과 중복 사용 불가 │
└──────────────────────────────┘
```

### 커스터마이징 옵션

#### 기본 설정
```javascript
var config = {
    title: "특별 할인 쿠폰!",
    description: "지금 바로 사용하세요",
    copyButtonText: "📋 코드 복사하기",
    copiedButtonText: "✅ 복사 완료!",
    redeemButtonText: "지금 사용하기",
    terms: "* 일부 상품 제외<br>* 다른 쿠폰과 중복 사용 불가"
};
```

#### 쿠폰 코드 설정
```javascript
// 정적 코드
var couponCode = "SAVE30";

// Liquid 동적 코드 (사용자별 고유 쿠폰)
var couponCode = "{{custom_attribute.${coupon_code}}}";
```

#### 할인 정보 설정
```javascript
// 퍼센트 할인
var discountInfo = {
    type: "percentage",  // "percentage" 또는 "amount"
    value: 30,           // 숫자만
    unit: "할인"
};

// 금액 할인
var discountInfo = {
    type: "amount",
    value: "10,000₩",    // 문자열
    unit: "할인"
};
```

#### 쿠폰 조건 정보
```javascript
var couponInfo = {
    showInfo: true,              // 조건 정보 표시 여부
    minPurchase: "50,000₩",      // 최소 주문 금액
    maxDiscount: "15,000₩",      // 최대 할인 금액
    expiryDate: "2026.01.31까지" // 유효 기간
};
```

#### 사용하기 버튼 설정
```javascript
var redeemUrl = "athlerab://checkout";
var linkType = "deeplink";  // "deeplink" 또는 "web"
```

### 작동 방식

1. **쿠폰 표시**: 쿠폰 코드 및 할인 정보 표시
2. **복사 기능**:
   - Clipboard API 우선 사용
   - 미지원 브라우저는 폴백 방식
   - 복사 성공 시 버튼 색상 변경 (빨강 → 초록)
3. **조건 정보**: 최소 금액, 최대 할인, 유효 기간 표시
4. **사용 CTA**: 쿠폰 적용 페이지로 이동 (딥링크/웹)
5. **이벤트 추적**: 조회, 복사, 사용 클릭 모두 로깅

### 커스텀 이벤트

| 이벤트명 | 트리거 시점 | 속성 |
|----------|-------------|------|
| `coupon_code_viewed` | 쿠폰 표시됨 | `coupon_code`, `discount_type`, `discount_value` |
| `coupon_code_copied` | 쿠폰 복사됨 | `coupon_code` |
| `coupon_redeem_click` | 사용하기 클릭 | `coupon_code` |

### 클릭 추적 버튼 ID

| 버튼 ID | 설명 |
|---------|------|
| `close_button` | 닫기 버튼 클릭 |
| `close_overlay` | 오버레이 배경 클릭 |
| `copy_button` | 코드 복사 버튼 클릭 |
| `redeem_button` | 사용하기 버튼 클릭 |

### 사용 사례

- **프로모션 쿠폰**: 시즌 세일, 이벤트 쿠폰 배포
- **신규 회원 환영**: 첫 구매 할인 쿠폰
- **재구매 유도**: 휴면 고객 복귀 쿠폰
- **장바구니 이탈**: 추가 할인 쿠폰 제공
- **생일 쿠폰**: 사용자별 생일 축하 쿠폰
- **VIP 쿠폰**: 등급별 특별 쿠폰

### AI 커스터마이징 예시

AI에게 쿠폰 템플릿 수정 요청:

```
"쿠폰 코드를 WINTER2026으로 바꿔줘"
"할인율을 50%로 변경해줘"
"금액 할인으로 바꿔서 10,000₩ 할인으로 표시해줘"
"최소 주문 금액을 100,000₩로 올려줘"
"유효 기간을 2026년 2월 28일까지로 바꿔줘"
"조건 정보 섹션을 숨겨줘"
"사용하기 버튼을 웹 링크로: https://shop.example.com"
"타이틀을 '윈터 세일 특가!'로 바꿔줘"
"약관을 '전 상품 적용 가능'으로 바꿔줘"
```

### 할인 타입별 설정

#### 퍼센트 할인 (%)
```javascript
var discountInfo = {
    type: "percentage",
    value: 30,         // 30%
    unit: "할인"
};
```

**표시**: 30% 할인

#### 금액 할인 (₩)
```javascript
var discountInfo = {
    type: "amount",
    value: "10,000₩",
    unit: "할인"
};
```

**표시**: 10,000₩ 할인

#### 포인트 적립
```javascript
var discountInfo = {
    type: "amount",
    value: "5,000P",
    unit: "적립"
};
```

**표시**: 5,000P 적립

### Liquid 변수 활용

#### 동적 쿠폰 코드
```javascript
var couponCode = "{{custom_attribute.${user_coupon_code}}}";
```

#### 동적 할인율
```javascript
var discountInfo = {
    type: "percentage",
    value: "{{custom_attribute.${discount_rate}}}",  // Liquid에서 숫자 반환
    unit: "할인"
};
```

#### 동적 유효 기간
```javascript
var couponInfo = {
    showInfo: true,
    minPurchase: "50,000₩",
    maxDiscount: "15,000₩",
    expiryDate: "{{custom_attribute.${coupon_expiry}}}"  // "2026.01.31까지"
};
```

### 쿠폰 배포 전략

#### 1. 세그먼트별 쿠폰
- **신규 가입자**: 첫 구매 20% 할인
- **VIP 고객**: 월간 특별 30% 쿠폰
- **휴면 고객**: 복귀 환영 15,000₩ 할인

#### 2. 행동 기반 트리거
- **장바구니 이탈**: 10% 추가 할인 쿠폰 발송
- **찜 목록 보유**: 찜한 상품 15% 할인
- **구매 후 7일**: 재구매 10,000₩ 쿠폰

#### 3. 시간 기반 프로모션
- **플래시 세일**: 1시간 한정 30% 쿠폰
- **주말 특가**: 금~일 20% 쿠폰
- **생일 쿠폰**: 생일 당일 + 7일 사용 가능

### 쿠폰 성과 측정

Braze에서 추적할 핵심 지표:

| 지표 | 설명 | Braze 활용 |
|------|------|-----------|
| **조회율** | `coupon_code_viewed` 이벤트 수 | 배포 도달률 |
| **복사율** | `coupon_code_copied` / 조회 | 관심도 측정 |
| **사용율** | `coupon_redeem_click` / 조회 | 전환 의도 |
| **실사용률** | 실제 주문 완료 / 복사 | ROI 측정 |
| **할인 금액** | 총 쿠폰 할인 금액 | 프로모션 비용 |

### 쿠폰 최적화 팁

1. **명확한 혜택**: "30% 할인" 명확하게 표시
2. **긴급성 조성**: "오늘까지", "선착순 100명"
3. **복사 용이성**: 원클릭 복사로 마찰 최소화
4. **조건 투명성**: 최소 금액, 제외 상품 명시
5. **즉각적 사용**: 복사 후 바로 쇼핑 페이지 이동
6. **A/B 테스트**: 할인율, 문구, 디자인 테스트

### 모범 사례

1. **사용자별 고유 쿠폰**: Liquid로 1회용 쿠폰 배포 (남용 방지)
2. **조건 명시**: 최소 금액, 최대 할인, 유효 기간 명확히
3. **약관 간결화**: 핵심 제한사항만 2-3줄로 요약
4. **CTA 강조**: "지금 사용하기" 버튼 눈에 띄게
5. **유효 기간 강조**: 만료 임박 시 빨간색으로 강조
6. **복사 후 액션**: 복사 성공 후 쇼핑 페이지로 자동 이동 옵션

### 브라우저 지원

- ✅ iOS Safari 12+ (Clipboard API)
- ✅ Android Chrome 80+ (Clipboard API)
- ✅ 레거시 브라우저 (execCommand 폴백)
- ✅ 모든 최신 모바일 브라우저

### 알려진 제한사항

- Clipboard API는 HTTPS 필수 (로컬 테스트 시 제한)
- 일부 구형 브라우저에서 복사 실패 가능 (수동 복사 안내)
- 쿠폰 코드 검증은 백엔드에서 수행 필요

### 팁

1. **백엔드 연동**: Braze 이벤트를 백엔드로 전송하여 쿠폰 사용 추적
2. **중복 방지**: 사용자별 고유 쿠폰 코드로 다계정 남용 방지
3. **실시간 재고**: 선착순 쿠폰은 실시간 재고 체크 필수
4. **유효 기간 관리**: Content Card로 만료된 쿠폰 자동 숨김
5. **세그멘테이션**: 쿠폰 복사 vs 미복사 사용자 분리 분석
6. **재타게팅**: 복사 후 미사용 사용자에게 리마인더 발송
