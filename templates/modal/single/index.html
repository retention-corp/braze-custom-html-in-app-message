<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0
        }
        html,
        body {
            width: 100%;
            height: 100%;
            font-family: -apple-system, system-ui, sans-serif;
            background: transparent;
        }
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            /* ============================================
               CUSTOMIZABLE: 오버레이 배경색
               ============================================
               AI 요청 예시: "오버레이를 더 어둡게/밝게 만들어줘"
               rgba(0,0,0,0.7) = 검정색 70% 투명 (기본값)
               rgba(0,0,0,0.9) = 검정색 90% 투명 (더 어둡게)
               rgba(0,0,0,0.5) = 검정색 50% 투명 (더 밝게)
            */
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .overlay.visible {
            opacity: 1
        }
        .modal {
            position: relative;
            /* ============================================
               CUSTOMIZABLE: 모달 크기
               ============================================
               AI 요청 예시: "모달을 더 크게/작게 만들어줘"
               max-width: 500px = 기본값
               max-width: 600px = 더 크게
               max-width: 400px = 더 작게
            */
            max-width: 500px;
            width: 100%;
            /* ============================================
               CUSTOMIZABLE: 모달 배경색
               ============================================
               AI 요청 예시: "모달 배경을 흰색으로 바꿔줘"
               #000000 = 검정색 (기본값)
               #ffffff = 흰색
               #F5F5F5 = 연한 회색
            */
            background: #000000;
            /* ============================================
               CUSTOMIZABLE: 모달 둥근 모서리
               ============================================
               AI 요청 예시: "모서리를 더 둥글게/덜 둥글게 만들어줘"
               16px = 기본값
               24px = 더 둥글게
               8px = 덜 둥글게
               0px = 직각
            */
            border-radius: 16px;
            overflow: hidden;
            transform: scale(0.9);
            transition: transform 0.3s;
        }
        .overlay.visible .modal {
            transform: scale(1)
        }
        .image-container {
            width: 100%;
            position: relative;
            cursor: pointer;
        }
        .image-container img {
            width: 100%;
            height: auto;
            display: block;
        }
        .close-button {
            position: absolute;
            /* ============================================
               CUSTOMIZABLE: 닫기 버튼 위치
               ============================================
               AI 요청 예시: "닫기 버튼을 왼쪽으로 옮겨줘"
               top: 12px, right: 12px = 오른쪽 상단 (기본값)
               top: 12px, left: 12px = 왼쪽 상단
            */
            top: 12px;
            right: 12px;
            width: 32px;
            height: 32px;
            /* ============================================
               CUSTOMIZABLE: 닫기 버튼 스타일
               ============================================
               AI 요청 예시: "닫기 버튼을 더 눈에 띄게 만들어줘"
            */
            background: rgba(0, 0, 0, 0.6);
            border-radius: 50%;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }
        .close-button svg {
            width: 16px;
            height: 16px;
        }
        .debug-tag {
            position: absolute;
            top: 10px;
            left: 10px;
            background: black;
            color: white;
            padding: 4px 8px;
            font-size: 10px;
            z-index: 9999;
            border-radius: 4px;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="overlay" id="overlay" onclick="c('close_overlay')">
        <div class="modal" onclick="event.stopPropagation()">
            <div class="debug-tag">V1_MODAL_SINGLE</div>
            <div class="image-container" id="img-container">
                <!-- ============================================
                     CUSTOMIZABLE: 이미지 URL
                     ============================================
                     AI 요청 예시: "이미지를 [URL]로 바꿔줘"
                     권장: 세로 비율 이미지 (예: 500x700)
                -->
                <img
                    src="https://storage.googleapis.com/meta-main-catalog-creatives-20251209/roi-ideaA/v3b_compact_darkband_bigfont_4448550_v4.jpg"
                    alt="promotion"
                    decoding="async"
                />
                <button class="close-button" id="close-btn">
                    <svg viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5">
                        <path d="M6 6L18 18M18 6L6 18"/>
                    </svg>
                </button>
            </div>
        </div>
    </div>
    <script>
        /* ============================================
           CUSTOMIZABLE: 클릭 시 이동할 링크
           ============================================
           AI 요청 예시:
           - "딥링크를 athlerab://product/999로 바꿔줘"
           - "웹 링크로 바꿔줘"
           - "클릭 시 프로모션 페이지로 이동하게 해줘"

           링크 타입 설명:
           - "deeplink": 앱 내부 딥링크 (예: athlerab://product/123)
           - "web": 웹 브라우저로 열리는 링크 (예: https://example.com)
           - 타입 생략 시: URL이 http로 시작하면 자동으로 web, 아니면 deeplink
        */
        var imageUrl = "athlerab://product/4448550";
        var linkType = "deeplink"; // "deeplink" 또는 "web" 또는 생략

        // Bridge ready flag
        var bridgeReady = false;

        // Braze Bridge Ready Event
        window.addEventListener("ab.BridgeReady", function() {
            bridgeReady = true;
        }, false);

        // Close message with click tracking
        function c(btnId) {
            if (bridgeReady && window.brazeBridge) {
                brazeBridge.logClick(btnId);
                brazeBridge.closeMessage();
            } else if (window.appboyBridge) {
                appboyBridge.logClick(btnId);
                appboyBridge.closeMessage();
            } else {
                document.getElementById("overlay").classList.remove("visible");
            }
        }

        // Image click with tracking and link type detection
        function handleImageClick() {
            if (bridgeReady && window.brazeBridge) {
                brazeBridge.logClick("image_click");
            } else if (window.appboyBridge) {
                appboyBridge.logClick("image_click");
            }

            if (imageUrl) {
                // 링크 타입이 지정되지 않았으면 URL로 자동 판단
                var type = linkType;
                if (!type) {
                    type = (imageUrl.indexOf('http') === 0) ? 'web' : 'deeplink';
                }

                // 웹 링크는 새 창으로, 딥링크는 현재 창으로
                if (type === 'web') {
                    window.open(imageUrl, '_blank');
                } else {
                    window.location.href = imageUrl;
                }
            }
        }

        // Initialize
        (function () {
            // Attach click handlers
            document.getElementById("img-container").addEventListener("click", handleImageClick);
            document.getElementById("close-btn").addEventListener("click", function(e) {
                e.stopPropagation();
                c("close_button");
            });

            /* ============================================
               CUSTOMIZABLE: 모달 표시 딜레이
               ============================================
               AI 요청 예시: "모달을 더 빨리/천천히 나타나게 해줘"
               300 = 0.3초 딜레이
               500 = 0.5초 딜레이
               0 = 즉시 표시
            */
            setTimeout(function () {
                document.getElementById("overlay").classList.add("visible");
            }, 300);
        })();
    </script>
</body>
</html>
